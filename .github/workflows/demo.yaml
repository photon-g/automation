
name: Sample
on: [push]

env:
  CBRANCH: ''
  CMSG: ''
  ERRMSG: ''

jobs:
  build:
    name: launch sample
    runs-on: ubuntu-latest
    steps:
    - name: checkout repo
      uses: actions/checkout@v2
   
    - name: setup python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10' # install the python version needed

    - name: install python packages
      run: |
          python -m pip install --upgrade pip
          pip install slack-notifications 

    - name: scan git branch
      run: python scan.py

  slackNotification:
    name: Slack Notification
    runs-on: ubuntu-latest
    
    steps:
    - name: Slack Notification
      uses: rtCamp/action-slack-notify@v2
    
      env:
        SLACK_TITLE: dry run 
        SLACK_WEBHOOK: ${{ secrets.PWHK }}

        ${{ if eq(env.ERRMSG,'')}}: 
          SLACK_MESSAGE: ${{ env.CBRANCH }}
        ${{ else }}:
          SLACK_MESSAGE: ${{ env.ERRMSG }} 
